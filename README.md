# üöÄ FastAPI + LangChain Demo: LLM-Agents API

–ü—Ä–∏–º–µ—Ä —É—á–µ–±–Ω–æ–≥–æ backend-—Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ **FastAPI** —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π **LangChain**-–∞–≥–µ–Ω—Ç–æ–≤.
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ API –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ç–∏–ø–∞–º–∏ LLM-–∞–≥–µ–Ω—Ç–æ–≤ ‚Äî –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∞—Ç-–±–æ—Ç–∞ –¥–æ ReAct-–∞–≥–µ–Ω—Ç–∞ —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏ —Å—É–º–º–∞—Ä–∏–∑–∞—Ç–æ—Ä–∞ —Ç–µ–∫—Å—Ç–æ–≤.

---

## üß≠ –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

–¶–µ–ª—å ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞–º, –∫–∞–∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è LLM-–∞–≥–µ–Ω—Ç–æ–≤:

- —Ä–∞–±–æ—Ç–∞ —Å FastAPI: –º–∞—Ä—à—Ä—É—Ç—ã (`Routers`), `Middleware`, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤;
- —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –º–æ–¥—É–ª—è–º (`core/`, `agents/`, `routers/`);
- –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ LLM —á–µ—Ä–µ–∑ `LangChain` –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `.env`;
- –ø—Ä–∏–º–µ—Ä ReAct-–∞–≥–µ–Ω—Ç–∞, —Å–ø–æ—Å–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (`Tools`) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
fastapi_llm_demo/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Pydantic Settings (.env)
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îî‚îÄ‚îÄ llm.py              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è LLM –∏ –±–∞–∑–æ–≤–∞—è —Ü–µ–ø–æ—á–∫–∞
‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îú‚îÄ‚îÄ registry.py         # –†–µ–µ—Å—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ chat_basic.py       # –ü—Ä–æ—Å—Ç–æ–π —á–∞—Ç-–∞–≥–µ–Ω—Ç (prompt ‚Üí –æ—Ç–≤–µ—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ chat_react.py       # ReAct-–∞–≥–µ–Ω—Ç —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ (LangChain 0.3.x)
‚îÇ   ‚îú‚îÄ‚îÄ summarizer.py       # –ê–≥–µ–Ω—Ç –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ tools.py            # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (time, word_count –∏ –¥—Ä.)
‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îú‚îÄ‚îÄ chat.py             # REST API –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∞–≥–µ–Ω—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ files.py            # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ health.py           # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è API
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example            # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md               # (–≤—ã —á–∏—Ç–∞–µ—Ç–µ –µ–≥–æ)
```

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
```bash
git clone https://github.com/<yourname>/fastapi_llm_demo.git
cd fastapi_llm_demo
```

### 2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
python -m venv .venv
source .venv/bin/activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `.env`
–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω –∏ –≤–ø–∏—Å–∞—Ç—å —Å–≤–æ–π API-–∫–ª—é—á:
```bash
cp .env .env
source .env
```

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:
```env
OPENAI_API_KEY2=sk-...
OPENAI_MODEL=gpt-4o-mini
LLM_TEMPERATURE=0.2
TIMEOUT_S=60
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```bash
uvicorn main:app --reload
```
–∏–ª–∏
```bash
python main.py
```

–û—Ç–∫—Ä–æ–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Swagger UI:
üëâ [http://127.0.0.1:8001/docs](http://127.0.0.1:8001/docs)

---

## üß© API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----------|-----------|
| `GET` | `/` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ |
| `GET` | `/health/` | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ç—É—Å API |
| `GET` | `/chat/agents` | –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ |
| `POST` | `/chat/` | –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ –∞–≥–µ–Ω—Ç—É |
| `POST` | `/files/upload-and-summarize` | –ó–∞–≥—Ä—É–∑–∫–∞ `.txt`/`.md` —Ñ–∞–π–ª–∞ –∏ –∫—Ä–∞—Ç–∫–æ–µ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ |

---

## üß† –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1 ‚Äî Chat-–∞–≥–µ–Ω—Ç
```json
POST /chat
{
  "user_prompt": "What time is it in UTC?",
  "agent": "chat-react"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "agent": "chat-react",
  "response": "The current UTC time is 2025-10-23T00:42:12."
}
```

### –ü—Ä–∏–º–µ—Ä 2 ‚Äî –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–∞
```bash
curl -X POST "http://127.0.0.1:8001/files/upload-and-summarize"      -F "file=@lecture_notes.txt"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "filename": "lecture_notes.txt",
  "summary": "- Key topic: LLM agent orchestration\n- Main idea: Function calling and ReAct\n..."
}
```

---

## üß∞ –ê–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

| –ê–≥–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|-------|-------------|-------------|
| **chat-basic** | –ü—Ä–æ—Å—Ç–æ–π LLM-—á–∞—Ç | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ Prompt ‚Üí LLM |
| **chat-react** | –ê–≥–µ–Ω—Ç —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ReAct-–ø–µ—Ç–ª—é –∏ `TOOLS` |
| **summarizer** | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤ | –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |

### üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (`agents/tools.py`)
- `current_time` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ UTC-–≤—Ä–µ–º—è
- `word_count` ‚Äî —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –æ—Ñ–æ—Ä–º–∏–≤ –∏—Ö –∫–∞–∫:
```python
from langchain.tools import tool

@tool("my_tool")
def my_tool(query: str) -> str:
    return "–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞"
```

---

## üß© Middleware –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ middleware, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
```
X-Process-Time: 0.183
```

–ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª, —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–ª–∏ –º–µ—Ç—Ä–∏–∫–∏ OpenTelemetry.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
pytest -q
```

–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `tests/test_chat.py`:
```python
def test_health(client):
    r = client.get("/health/")
    assert r.status_code == 200
    assert "ok" in r.json()["status"]
```

---

## üìò –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞–º–∫–∞—Ö –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã
**¬´–ú–µ—Ç–æ–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ü–û —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM¬ª (–ú–ò–§–ò, –ò–ò–ö–°)**

**–¶–µ–ª—å:**
–ù–∞—É—á–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å—Ç—Ä–æ–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ backend-—Å–µ—Ä–≤–∏—Å—ã —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π LLM-–∞–≥–µ–Ω—Ç–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –ø–æ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–º —à–∞–±–ª–æ–Ω–∞–º (routers, core, config, agents).

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ¬© 2025 ‚Äî —É—á–µ–±–Ω—ã–π –¥–µ–º–æ-–ø—Ä–æ–µ–∫—Ç –ú–ò–§–ò / –ò–Ω—Å—Ç–∏—Ç—É—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∫–∏–±–µ—Ä–Ω–µ—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º
–ê–≤—Ç–æ—Ä: [–î–∞–Ω–∏–∏–ª –°—É—Ö–æ—Ä—É–∫–æ–≤](https://github.com/dsuhoi)

---

> üí° –°–æ–≤–µ—Ç –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:
> –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞ (`translator.py`) –∏–ª–∏ –∞–Ω–∞–ª–∏–∑–∞ CSV-—Ñ–∞–π–ª–æ–≤ (`data_analyst.py`).
> –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ FastAPI + LLM.
